
# 2.1 Транспиляторы

ES2015 (шестая версия спецификации) достигла финального состояния в 2015 году.  
Современные браузеры её поддерживают, но всё ещё существуют старые версии браузеров,
которые поддерживают её частично или не поддерживают совсем.  
С учётом того, что спецификации выходят каждый год (ES2016, ES2017 и т.д.),
всегда будут браузеры, которые отстают.

Возникает вопрос: какой смысл использовать новые возможности, если нужно следить за совместимостью?
Разработчики нашли решение — **транспилятор**.

---

## Что делает транспилятор

- **Принимает код на ES2015+ и генерирует код на ES5**, который понимают все браузеры.
- **Создаёт source maps** — специальные файлы, которые позволяют при отладке
  видеть исходный ES2015+ код, а не преобразованный ES5.

### Пример:
**Исходный код (ES2015+):**
```javascript
const greet = (name = 'World') => `Hello, ${name}!`;
```

**После транспиляции в ES5:**
```javascript
"use strict";

var greet = function greet(name) {
  if (name === void 0) {
    name = 'World';
  }
  return "Hello, " + name + "!";
};
```

**Без source maps** при отладке вы бы видели только этот сгенерированный ES5-код,  
что делает поиск ошибок сложным.  
**С source maps** браузер показывает именно ваш оригинальный ES2015+ код,  
хотя фактически выполняется старый.

---

## История: Traceur → TypeScript

### Traceur
**Traceur** — транспилятор от Google, который конвертировал ES2015+ в ES5.  
Он стал первым крупным инструментом, позволившим писать на новом JavaScript и запускать
его во всех браузерах.  
Первые версии Angular 2 действительно писали на **ES2015+**, а для совместимости
прогоняли этот код через **Traceur**.

### Почему перешли на TypeScript?
Со временем команда Angular решила переписать проект на **TypeScript**, потому что:
- TypeScript — **надмножество JavaScript**, совместимое с существующим кодом;
- он предоставляет **сильную систему типов**;
- поддерживает **декораторы** (критически важны для Angular);
- и сам TypeScript компилирует код в обычный JavaScript.

---

## Babel — стандарт де-факто

### Что такое Babel?
**Babel** — это транспилятор JavaScript, который:
- преобразует **новый синтаксис JS (ES2015+)** в более старый стандарт (обычно ES5), чтобы код работал в любом браузере;
- поддерживает **плагины** и **пресеты**, позволяющие выбрать, какие возможности языка нужно преобразовывать;
- генерирует **source maps**, чтобы при отладке видеть оригинальный код.

### Как это работает?
1. **Парсинг кода**: Babel считывает исходный JS-код и строит его **AST** (Abstract Syntax Tree).  
2. **Плагины преобразования**: дерево модифицируется (например, стрелочные функции → обычные).  
3. **Генерация кода**: создаётся новый JavaScript-код, совместимый с целевыми браузерами.

### Зачем использовать Babel?
- Использовать **новые возможности языка** без ожидания их поддержки в браузерах.
- Подключать **экспериментальные фичи** (через плагины).
- Унифицировать поведение кода во всех средах (браузеры, Node.js).

### Где используется?
- **Веб-приложения** (React, Angular, Vue и др.) — для поддержки новейшего синтаксиса.  
- **Библиотеки** — чтобы распространять код, совместимый с большим количеством окружений.  
- **Серверный JS (Node.js)**, когда нужна поддержка определённых версий.

### Итог
**Babel** стал стандартом де-факто для транспиляции, потому что:
- активно развивается;
- поддерживает последние спецификации;
- имеет большую экосистему плагинов и пресетов;
- позволяет писать код на **современном JavaScript** уже сегодня.

---

## Рекомендации

- Использовать **Babel** для проектов на JavaScript без TypeScript, чтобы писать на ES2015+ и новее.  
- Для крупных проектов (например, Angular) использовать **TypeScript**, который сразу включает транспиляцию и систему типов.
